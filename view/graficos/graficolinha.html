<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carbono este ano</title>
  <style>
    #chartdiv {
      width: 100%;
      height: 500px;
      max-width:100%;
    }
    </style>

    <!-- Resources -->
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
</head>
<!-- HTML -->
<body>
  <div id="chartdiv"></div>



<!-- Chart code -->
<script>
am5.ready(function() {
  var root = am5.Root.new("chartdiv");
  root.setThemes([am5themes_Animated.new(root)]);

  // Configurar cores padrão para texto
  root.interfaceColors.set("text", am5.color(0xFFFFFF)); // Texto branco global

  var value = 100;

  function generateChartData() {
    var chartData = [];
    var firstDate = new Date();
    firstDate.setDate(firstDate.getDate() - 1000);
    firstDate.setHours(0, 0, 0, 0);

    for (var i = 0; i < 50; i++) {
      var newDate = new Date(firstDate);
      newDate.setSeconds(newDate.getSeconds() + i);
      value += (Math.random() < 0.5 ? 1 : -1) * Math.random() * 10;
      chartData.push({ date: newDate.getTime(), value: value });
    }
    return chartData;
  }

  var data = generateChartData();

  var chart = root.container.children.push(am5xy.XYChart.new(root, {
    focusable: true,
    panX: true,
    panY: true,
    wheelX: "panX",
    wheelY: "zoomX",
    pinchZoomX: true,
    paddingLeft: 0
  }));

  var easing = am5.ease.linear;

  // EIXO X - CONFIGURAÇÕES DE COR
  var xAxis = chart.xAxes.push(am5xy.DateAxis.new(root, {
    maxDeviation: 0.5,
    groupData: false,
    extraMax: 0.1,
    extraMin: -0.1,
    baseInterval: { timeUnit: "second", count: 1 },
    renderer: am5xy.AxisRendererX.new(root, {
      minGridDistance: 50,
      stroke: am5.color(0xFFFFFF), // Linha do eixo em branco
      strokeOpacity: 1,
      strokeWidth: 1
    })
  }));

  // Configurar rótulos do eixo X
  xAxis.get("renderer").labels.template.setAll({
    fill: am5.color(0xFFFFFF), // Texto branco
    fontSize: 12
  });

  // Configurar linhas de grade do eixo X
  xAxis.get("renderer").grid.template.setAll({
    stroke: am5.color(0xFFFFFF), // Linhas de grade brancas
    strokeOpacity: 0.2
  });

  

  // EIXO Y - CONFIGURAÇÕES DE COR
  var yAxis = chart.yAxes.push(am5xy.ValueAxis.new(root, {
    renderer: am5xy.AxisRendererY.new(root, {
      stroke: am5.color(0xFFFFFF), // Linha do eixo em branco
      strokeOpacity: 1,
      strokeWidth: 1
    })
  }));

  

  // Configurar rótulos do eixo Y
  yAxis.get("renderer").labels.template.setAll({
    fill: am5.color(0xFFFFFF), // Texto branco
    fontSize: 12
  });

  // Configurar linhas de grade do eixo Y
  yAxis.get("renderer").grid.template.setAll({
    stroke: am5.color(0xFFFFFF), // Linhas de grade brancas
    strokeOpacity: 0.2
  });

  // Série de dados
  var series = chart.series.push(am5xy.LineSeries.new(root, {
    name: "Series 1",
    xAxis: xAxis,
    yAxis: yAxis,
    valueYField: "value",
    valueXField: "date",
    stroke: am5.color(0x00FF00), // Linha verde para contraste
    tooltip: am5.Tooltip.new(root, { pointerOrientation: "horizontal" })
  }));

  data[data.length - 1].bullet = true;
  series.data.setAll(data);

  // Configurar marcadores
  series.bullets.push(function(root, series, dataItem) {  
    if (dataItem.dataContext.bullet) {    
      var container = am5.Container.new(root, {});
      var circle0 = container.children.push(am5.Circle.new(root, {
        radius: 5,
        fill: am5.color(0xFF0000) // Marcador vermelho
      }));
      var circle1 = container.children.push(am5.Circle.new(root, {
        radius: 5,
        fill: am5.color(0xFF0000) // Marcador vermelho
      }));

      circle1.animate({
        key: "radius",
        to: 20,
        duration: 1000,
        easing: am5.ease.out(am5.ease.cubic),
        loops: Infinity
      });
      circle1.animate({
        key: "opacity",
        to: 0,
        from: 1,
        duration: 1000,
        easing: am5.ease.out(am5.ease.cubic),
        loops: Infinity
      });

      return am5.Bullet.new(root, {
        locationX: undefined,
        sprite: container
      })
    }
  });

  // Cursor
  var cursor = chart.set("cursor", am5xy.XYCursor.new(root, {
    xAxis: xAxis,
    yAxis: yAxis,
    behavior: "zoomXY"
  }));
  cursor.lineX.set("stroke", am5.color(0xFFFFFF)); // Linha do cursor branca
  cursor.lineY.set("stroke", am5.color(0xFFFFFF)); // Linha do cursor branca

  // Atualização de dados em tempo real
  setInterval(addData, 1000);

  function addData() {
    var lastDataItem = series.dataItems[series.dataItems.length - 1];
    var lastValue = lastDataItem.get("valueY");
    var newValue = lastValue + ((Math.random() < 0.5 ? 1 : -1) * Math.random() * 5);
    var lastDate = new Date(lastDataItem.get("valueX"));
    var time = am5.time.add(new Date(lastDate), "second", 1).getTime();
    
    series.data.removeIndex(0);
    series.data.push({ date: time, value: newValue });
    
    var newDataItem = series.dataItems[series.dataItems.length - 1];
    newDataItem.animate({ key: "valueYWorking", to: newValue, from: lastValue, duration: 600, easing: easing });
    
    if (newDataItem.bullet) {
      newDataItem.bullets = [];
      newDataItem.bullets[0] = lastDataItem.bullets[0];
      newDataItem.bullets[0].get("sprite").dataItem = newDataItem;
    }
    lastDataItem.dataContext.bullet = false;
    lastDataItem.bullets = [];
  }

  chart.appear(1000, 100);
});
</script>


</body>
</html>
